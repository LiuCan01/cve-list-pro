Name: CVE-2004-1018
Status: Candidate
URL: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1018
Phase: Assigned (20041104)
Category: SF
Reference: BUGTRAQ:20041219 PHP shmop.c module permits write of arbitrary memory.
Reference: URL:http://www.securityfocus.com/archive/1/384920
Reference: BUGTRAQ:20041215 Advisory 01/2004: Multiple vulnerabilities in PHP 4/5
Reference: URL:http://marc.info/?l=bugtraq&m=110314318531298&w=2
Reference: MISC:http://www.hardened-php.net/advisories/012004.txt
Reference: CONFIRM:http://www.php.net/release_4_3_10.php
Reference: FEDORA:FLSA:2344
Reference: URL:https://bugzilla.fedora.us/show_bug.cgi?id=2344
Reference: HP:HPSBMA01212
Reference: URL:http://www.securityfocus.com/advisories/9028
Reference: MANDRAKE:MDKSA-2004:151
Reference: URL:http://www.mandriva.com/security/advisories?name=MDKSA-2004:151
Reference: MANDRAKE:MDKSA-2005:072
Reference: URL:http://www.mandriva.com/security/advisories?name=MDKSA-2005:072
Reference: REDHAT:RHSA-2005:032
Reference: URL:http://www.redhat.com/support/errata/RHSA-2005-032.html
Reference: REDHAT:RHSA-2005:816
Reference: URL:http://www.redhat.com/support/errata/RHSA-2005-816.html
Reference: UBUNTU:USN-99-1
Reference: URL:https://www.ubuntu.com/usn/usn-99-1/
Reference: BID:12045
Reference: URL:http://www.securityfocus.com/bid/12045
Reference: OSVDB:12411
Reference: URL:http://www.osvdb.org/12411
Reference: OVAL:oval:org.mitre.oval:def:10949
Reference: URL:https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A10949
Reference: XF:php-shmopwrite-outofbounds-memory(18515)
Reference: URL:https://exchange.xforce.ibmcloud.com/vulnerabilities/18515

Multiple integer handling errors in PHP before 4.3.10 allow attackers
to bypass safe mode restrictions, cause a denial of service, or
execute arbitrary code via (1) a negative offset value to the
shmop_write function, (2) an "integer overflow/underflow" in the pack
function, or (3) an "integer overflow/underflow" in the unpack
function.  NOTE: this issue was originally REJECTed by its CNA before
publication, but that decision is in active dispute.  This candidate
may change significantly in the future as a result of further
discussion.


Current Votes:
   REVIEWING(1) Christey

Voter Comments:
 Christey> There is active disagreement regarding whether this satisfies the
   criteria for inclusion in CVE, because the attack vectors require
   function parameters that are typically controlled only by the
   application developer, not an external attacker.  This would mean that
   the PHP application owner could exploit it
   
   Since various PHP functions already allow the application owner to
   execute commands, no additional privileges would be gained by
   exploiting such a bug.  However, if safe_mode is enabled in PHP, then
   the PHP functions related to execution are restricted
   (e.g. shell_exec()).  Thus, exploitation may allow the PHP application
   owner to execute code *despite* the configured restrictions imposed by
   safe mode, which then qualifies this as a vulnerability.


