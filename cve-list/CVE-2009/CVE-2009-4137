Name: CVE-2009-4137
Status: Candidate
URL: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4137
Phase: Assigned (20091201)
Category: 
Reference: MLIST:[oss-security] 20091209 Piwik <= 0.4.5 Cookie Unserialize() Vulnerability
Reference: URL:http://www.openwall.com/lists/oss-security/2009/12/09/2
Reference: MLIST:[oss-security] 20091210 Re: Piwik <= 0.4.5 Cookie Unserialize() Vulnerability
Reference: URL:http://www.openwall.com/lists/oss-security/2009/12/10/1
Reference: MLIST:[oss-security] 20091214 Re: Piwik <= 0.4.5 Cookie Unserialize() Vulnerability
Reference: URL:http://www.openwall.com/lists/oss-security/2009/12/14/2
Reference: MISC:http://www.sektioneins.de/en/advisories/advisory-032009-piwik-cookie-unserialize-vulnerability/
Reference: MISC:http://www.suspekt.org/2009/12/09/advisory-032009-piwik-cookie-unserialize-vulnerability/
Reference: MISC:http://www.suspekt.org/downloads/POC2009-ShockingNewsInPHPExploitation.pdf
Reference: CONFIRM:http://dev.piwik.org/trac/changeset/1637
Reference: CONFIRM:http://piwik.org/blog/2009/12/piwik-response-to-shocking-news-in-php-exploitation/

The loadContentFromCookie function in core/Cookie.php in Piwik before
0.5 does not validate strings obtained from cookies before calling the
unserialize function, which allows remote attackers to execute
arbitrary code or upload arbitrary files via vectors related to the
__destruct function in the Piwik_Config class; php://filter URIs; the
__destruct functions in Zend Framework, as demonstrated by the
Zend_Log destructor; the shutdown functions in Zend Framework, as
demonstrated by the Zend_Log_Writer_Mail class; the render function in
the Piwik_View class; Smarty templates; and the _eval function in
Smarty.


Current Votes:
None (candidate not yet proposed)


