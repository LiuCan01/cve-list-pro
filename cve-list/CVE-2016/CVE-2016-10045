Name: CVE-2016-10045
Status: Candidate
URL: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10045
Phase: Assigned (20161226)
Category: 
Reference: BUGTRAQ:20161228 PHPMailer < 5.2.20 Remote Code Execution PoC 0day Exploit (CVE-2016-10045) (Bypass of the CVE-2016-1033 patch)
Reference: URL:http://www.securityfocus.com/archive/1/archive/1/539967/100/0/threaded
Reference: EXPLOIT-DB:40969
Reference: URL:https://www.exploit-db.com/exploits/40969/
Reference: EXPLOIT-DB:42221
Reference: URL:https://www.exploit-db.com/exploits/42221/
Reference: EXPLOIT-DB:40986
Reference: URL:https://www.exploit-db.com/exploits/40986/
Reference: FULLDISC:20161227 PHPMailer < 5.2.20 Remote Code Execution PoC 0day Exploit (CVE-2016-10045) (Bypass of the CVE-2016-1033 patch)
Reference: URL:http://seclists.org/fulldisclosure/2016/Dec/81
Reference: MLIST:[oss-security] 20161228 Re: PHPMailer < 5.2.18 Remote Code Execution [updated advisory] [CVE-2016-10033]
Reference: URL:http://openwall.com/lists/oss-security/2016/12/28/1
Reference: MISC:http://packetstormsecurity.com/files/140286/PHPMailer-Remote-Code-Execution.html
Reference: MISC:https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html
Reference: MISC:http://packetstormsecurity.com/files/140350/PHPMailer-Sendmail-Argument-Injection.html
Reference: MISC:http://www.rapid7.com/db/modules/exploit/multi/http/phpmailer_arg_injection
Reference: CONFIRM:https://developer.joomla.org/security-centre/668-20161205-phpmailer-security-advisory.html
Reference: CONFIRM:https://github.com/PHPMailer/PHPMailer/releases/tag/v5.2.20
Reference: CONFIRM:https://github.com/PHPMailer/PHPMailer/wiki/About-the-CVE-2016-10033-and-CVE-2016-10045-vulnerabilities
Reference: BID:95130
Reference: URL:http://www.securityfocus.com/bid/95130
Reference: SECTRACK:1037533
Reference: URL:http://www.securitytracker.com/id/1037533

The isMail transport in PHPMailer before 5.2.20 might allow remote
attackers to pass extra parameters to the mail command and
consequently execute arbitrary code by leveraging improper interaction
between the escapeshellarg function and internal escaping performed in
the mail function in PHP. NOTE: this vulnerability exists because of
an incorrect fix for CVE-2016-10033.


Current Votes:
None (candidate not yet proposed)


