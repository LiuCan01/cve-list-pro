Name: CVE-2017-12629
Status: Candidate
URL: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-12629
Phase: Assigned (20170807)
Category: 
Reference: EXPLOIT-DB:43009
Reference: URL:https://www.exploit-db.com/exploits/43009/
Reference: MLIST:[lucene-dev] 20171012 Re: Several critical vulnerabilities discovered in Apache Solr (XXE & RCE)
Reference: URL:https://s.apache.org/FJDl
Reference: MLIST:[www-announce] 20171019 [SECURITY] CVE-2017-12629: Several critical vulnerabilities discovered in Apache Solr (XXE & RCE)
Reference: URL:http://mail-archives.us.apache.org/mod_mbox/www-announce/201710.mbox/%3CCAOOKt51UO_6Vy%3Dj8W%3Dx1pMbLW9VJfZyFWz7pAnXJC_OAdSZubA%40mail.gmail.com%3E
Reference: MISC:http://openwall.com/lists/oss-security/2017/10/13/1
Reference: MISC:https://twitter.com/ApacheSolr/status/918731485611401216
Reference: MISC:https://twitter.com/joshbressers/status/919258716297420802
Reference: MISC:https://twitter.com/searchtools_avi/status/918904813613543424
Reference: REDHAT:RHSA-2017:3123
Reference: URL:https://access.redhat.com/errata/RHSA-2017:3123
Reference: REDHAT:RHSA-2017:3124
Reference: URL:https://access.redhat.com/errata/RHSA-2017:3124
Reference: REDHAT:RHSA-2017:3244
Reference: URL:https://access.redhat.com/errata/RHSA-2017:3244
Reference: REDHAT:RHSA-2017:3451
Reference: URL:https://access.redhat.com/errata/RHSA-2017:3451
Reference: REDHAT:RHSA-2017:3452
Reference: URL:https://access.redhat.com/errata/RHSA-2017:3452
Reference: REDHAT:RHSA-2018:0002
Reference: URL:https://access.redhat.com/errata/RHSA-2018:0002
Reference: REDHAT:RHSA-2018:0003
Reference: URL:https://access.redhat.com/errata/RHSA-2018:0003
Reference: REDHAT:RHSA-2018:0004
Reference: URL:https://access.redhat.com/errata/RHSA-2018:0004
Reference: REDHAT:RHSA-2018:0005
Reference: URL:https://access.redhat.com/errata/RHSA-2018:0005
Reference: BID:101261
Reference: URL:http://www.securityfocus.com/bid/101261

Remote code execution occurs in Apache Solr before 7.1 with Apache
Lucene before 7.1 by exploiting XXE in conjunction with use of a
Config API add-listener command to reach the RunExecutableListener
class. Elasticsearch, although it uses Lucene, is NOT vulnerable to
this. Note that the XML external entity expansion vulnerability occurs
in the XML Query Parser which is available, by default, for any query
request with parameters deftype=xmlparser and can be exploited to
upload malicious data to the /upload request handler or as Blind XXE
using ftp wrapper in order to read arbitrary local files from the Solr
server. Note also that the second vulnerability relates to remote code
execution using the RunExecutableListener available on all affected
versions of Solr.


Current Votes:
None (candidate not yet proposed)


