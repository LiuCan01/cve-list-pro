Name: CVE-2017-7692
Status: Candidate
URL: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7692
Phase: Assigned (20170411)
Category: 
Reference: EXPLOIT-DB:41910
Reference: URL:https://www.exploit-db.com/exploits/41910/
Reference: MISC:http://openwall.com/lists/oss-security/2017/04/19/6
Reference: MISC:http://openwall.com/lists/oss-security/2017/04/27/1
Reference: MISC:https://legalhackers.com/advisories/SquirrelMail-Exploit-Remote-Code-Exec-CVE-2017-7692-Vuln.html
Reference: DEBIAN:DSA-3852
Reference: URL:http://www.debian.org/security/2017/dsa-3852
Reference: GENTOO:GLSA-201709-13
Reference: URL:https://security.gentoo.org/glsa/201709-13
Reference: BID:98067
Reference: URL:http://www.securityfocus.com/bid/98067
Reference: SECTRACK:1038312
Reference: URL:http://www.securitytracker.com/id/1038312

SquirrelMail 1.4.22 (and other versions before 20170427_0200-SVN)
allows post-authentication remote code execution via a sendmail.cf
file that is mishandled in a popen call. It's possible to exploit this
vulnerability to execute arbitrary shell commands on the remote
server. The problem is in the Deliver_SendMail.class.php with the
initStream function that uses escapeshellcmd() to sanitize the
sendmail command before executing it. The use of escapeshellcmd() is
not correct in this case since it doesn't escape whitespaces, allowing
the injection of arbitrary command parameters. The problem is in
-f$envelopefrom within the sendmail command line. Hence, if the target
server uses sendmail and SquirrelMail is configured to use it as a
command-line program, it's possible to trick sendmail into using an
attacker-provided configuration file that triggers the execution of an
arbitrary command. For exploitation, the attacker must upload a
sendmail.cf file as an email attachment, and inject the sendmail.cf
filename with the -C option within the "Options > Personal
Informations > Email Address" setting.


Current Votes:
None (candidate not yet proposed)


