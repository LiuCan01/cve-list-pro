#! /bin/bash

NEW_CVE=$1
LAST_CVE=$2

WORKDIR=`mktemp -d`
CURRENT_DIR=`pwd`
mkdir -p $WORKDIR/CVE_DES/

cp $NEW_CVE  $WORKDIR/
cp $LAST_CVE  $WORKDIR/

cat $NEW_CVE  | grep  '^Name: CVE-' | sort -n > $WORKDIR/new_cve_list
cat $LAST_CVE  | grep  '^Name: CVE-' | sort -n > $WORKDIR/last_cve_list

diff $WORKDIR/new_cve_list $WORKDIR/last_cve_list|grep '^<'| awk '{print $3}' > $WORKDIR/cve_diff_list

cd $WORKDIR/CVE_DES/
while read line; 
do
   wget https://nvd.nist.gov/vuln/detail/$line
done <  $WORKDIR/cve_diff_list


cp -r $WORKDIR $CURRENT_DIR/ 
rm -fr $WORKDIR
