import os
import sys
import re

def get_severityi_v2(html):
    pattern = """CVSS v2 Base Score.*?<a href=.*?>\s*?(.*?)</a>.*?</dd>"""
    m = re.search(pattern, html, re.S)
    print  m.group(1).strip()


def get_severityi_v3(html):
    pattern = """CVSS v3 Base Score.*?<a href=.*?>\s*?(.*?)</a>.*?</dd>"""
    m = re.search(pattern, html, re.S)
    print  m.group(1).strip()

if __name__ == "__main__":
    if len(sys.argv) != 2:
        sys.exit("Parameter not right")

    file_html = sys.argv[1]

    if os.path.exists(file_html):
        pass
    else:
        print "File %s not exist"%file_html

    fopen_html = open(file_html)
    read_html = fopen_html.read()
    get_severityi_v2(read_html)
    get_severityi_v3(read_html)

    fopen_html.close()
